# {{ ansible_managed }}

[Unit]
Description={{ aem_cms_service_name }}
After=multi-user.target
Requires=network.target

[Service]
Type=forking
PIDFile={{ aem_cms_home }}/crx-quickstart/conf/cq.pid

LimitNOFILE={{ aem_cms_limit_nofile }}

User={{ aem_cms_user }}
Group={{ aem_cms_group }}

ExecStart={{ aem_cms_home }}/crx-quickstart/bin/start
# sleep some time after start to ensure pid file is present for systemd
ExecStartPost=/bin/sleep 5s

ExecStop={{ aem_cms_stop_sync_path }}

# Do not kill the process because sync stop script is taking care of this
KillMode=none

# Wait at least one second before restart
RestartSec=1

[Install]
WantedBy=multi-user.target
